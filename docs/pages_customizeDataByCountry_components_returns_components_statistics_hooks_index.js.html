<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/customizeDataByCountry/components/returns/components/statistics/hooks/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/customizeDataByCountry/components/returns/components/statistics/hooks/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// REACT
import { useEffect } from "react";
import { quarterId } from "../../../../../../../hooks/fetch";

/**
 * Obtiene datos de una API, los filtra, los ordena y los establece en un estado
 * @param setData - la función que establece los datos en el componente
 * @param countryID - El ID del país del que desea obtener los datos.
 * @param period - el período del año (trimestre)
 * @param year - El año a consultar
 * @param list - "asc" o "desc" o "predeterminado"
 */
export const useSortedDepartments = (
  setData,
  countryID,
  period,
  year,
  list
) => {
  useEffect(() => {
    if (period?.length > 0 &amp;&amp; year?.length > 0) {
      fetch(
        `${
          import.meta.env.VITE_APP_API_URL
        }/consultas/totalpordepartamento/${countryID}/${year}/${encodeURI(
          quarterId[period]
        )}`
      )
        .then((req) => req.json())
        .then((data) => {
          let total = 0;
          let filteredData = data.data.map((department) => {
            total += department.total;

            const dep = {
              ...department,
              id: department._id
                .toLowerCase()
                .replaceAll(" ", "")
                .replaceAll("department", "")
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, ""),
            };
            return dep;
          });
          if (list === "asc" || list === "default" || list?.length === 0) {
            filteredData = filteredData.sort((a, b) => {
              return b.total - a.total;
            });
          }
          if (list === "desc") {
            filteredData = filteredData.sort((a, b) => {
              return a.total - b.total;
            });
          }
          if (filteredData.length > 5) {
            filteredData.length = 5;
          }
          setData(filteredData);
        });
    }
  }, [countryID, period, year, list]);
};

export default useSortedDepartments;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#handleGraphType">handleGraphType</a></li><li><a href="global.html#onDragEnd">onDragEnd</a></li><li><a href="global.html#reorder">reorder</a></li><li><a href="global.html#sendContactEmail">sendContactEmail</a></li><li><a href="global.html#updateSection">updateSection</a></li><li><a href="global.html#useFetch">useFetch</a></li><li><a href="global.html#useGraphData">useGraphData</a></li><li><a href="global.html#useHeatColors">useHeatColors</a></li><li><a href="global.html#useHeatmap">useHeatmap</a></li><li><a href="global.html#usePeriodReload">usePeriodReload</a></li><li><a href="global.html#useSortedDepartments">useSortedDepartments</a></li><li><a href="global.html#useSVGResize">useSVGResize</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Mon Aug 01 2022 23:45:35 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
